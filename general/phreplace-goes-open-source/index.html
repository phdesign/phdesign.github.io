



<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Paul Heasley">
  

  <title>phreplace Goes Open Source | phdesign</title>
  <meta name="description" content="I’ve decided to release phreplace as open source software in order to continue it’s development, I no longer have the time to give it the attention it requir...">

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="canonical" href="http://phdesign.com.au/general/phreplace-goes-open-source/">
  <link rel="alternate" type="application/rss+xml" title="phdesign" href="/feed.xml">
  <link rel="shortcut icon" href="/favicon.ico">

  
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MTPZZRZTVF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-MTPZZRZTVF');
</script>


  
  <script data-ad-client="ca-pub-5982856679845951" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,300;1,400;1,700;1,900&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

  <body class="post">

    <div class="header-background-image"></div>
    <header role="banner">
      <div class="header-top">
        
<nav class="navbar navbar-default">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/" title="phdesign homepage">ph<span class="brand-muted">design</span></a>
    </div><!-- end .navbar-header -->

    <div class="collapse navbar-collapse" id="navbar-collapse">
      <ul class="nav navbar-nav">
        <li class="active"><a href="/">Home <span class="sr-only">(current)</span></a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Blog <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            
              <li><a href="/programming">programming</a></li>
            
              <li><a href="/general">general</a></li>
            
              <li><a href="/woodworking">woodworking</a></li>
            
              <li><a href="/infosec">infosec</a></li>
            
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Projects <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="/album-rsync">album-rsync</a></li>
            <li><a href="/npptoolbucket">NppToolBucket</a></li>
            <li><a href="/betternote">BetterNote</a></li>
            <li><a href="/phreplace">phReplace</a></li>
          </ul>
        </li>
        <li><a href="/presentations">Presentations</a></li>
        <li><a href="/contact">Contact me</a></li>
      </ul>

    </div><!-- end .navbar-collapse -->
  </div><!-- end .container -->
</nav>

      </div><!-- end .header-top -->

      

    </header>
    <main class="content" aria-label="Content">
  	  <article>
  <div class="container">

    <div class="date-stamp">
      <div class="month">Jun</div>
      <div class="day">14</div>
    </div><!-- end .date-stamp -->

    <h2 class="post-header">phreplace Goes Open Source</h2>

    <div class="meta-label">
      posted on <span class="meta-value muted">14 June 2010</span>
      
        in <span class="meta-value"><a href="/general">general</a></span>
      
    </div><!-- end .meta-label -->
    <br />

    
    
    
    
      <p class="deprecated alert alert-warning"><b>Warning:</b> Please consider that this post is over 12 years old and the content may no longer be relevant.</p>
    

    <!--
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-5982856679845951"
     data-ad-slot="6503377131"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

-->
    <p>I’ve decided to release phreplace as open source software in order to continue it’s development, I no longer have the time to give it the attention it requires.</p>

<p>The VB6 source code will be released under the GNU Lesser General Public License (LGPL), in my understanding this means that anyone can use phreplace and even include the library in a greater works (e.g. PSPad), however if they modify the code it must be released under a similar open source library, in order that everyone will benefit from the changes.</p>

<p>The source code is available at <a href="https://www.assembla.com/spaces/phreplace/documents" title="phreplace source code available at Assembla">Assembla</a>, feel free to send any code changes to me to be included in the project.</p>

<!--more-->

<h3 id="architecture">Architecture</h3>
<p>I rewrote phreplace in early 2009 when I was studying design patterns and as such the VB6 source code is heavily object-oriented and pattern focused. VB6 is not strictly an oo language but it does support inheritance through the ‘Implements’ keyword.</p>

<p>phreplace uses the iterator, observer and factory methods. I found some of the sample chapters of <em>Visual Basic design patterns: VB 6.0 and VB.NET</em> By James William Cooper on <a href="http://books.google.com.au/books?id=TLhvRJTKDssC&amp;lpg=PP1&amp;pg=PP1#v=onepage&amp;q&amp;f=false" title="Visual Basic design patterns: VB 6.0 and VB.NET By James William Cooper">Google Books</a> a very useful resource.</p>

<p>This early <a href="/assets/files/phreplace-architecture.pdf">class architecture diagram (PDF)</a> may help decipher some of the code design.</p>

<h3 id="future-direction">Future Direction</h3>
<p>phreplace was designed to be application agnostic, it currently works only with PSPad but I hoped that by implementing only a few interfaces (IHostAdapter, IDocument and IDocumentCollection) it could work with any other editor that supported the basic operations required. My next intended editor to support was SciTE.</p>

<p>The first major change that I would like to see is support for Vista / Windows 7. At present the phreplace.vbs script intialises the application by checking to see if the phreplace.dll library is registered, if it isn’t it tries to register it with regsvr32. This works for Windows XP but standard users aren’t able to register libraries in Vista / Windows 7. So far I have come up with 3 solutions.</p>

<ul>
  <li>Override DllRegisterServer using <a href="http://vb.mvps.org/tools/vbAdvance/" title="Classic VB Tools: vbAdvance">vbAdvance</a>. I can’t get this library to work. See <a href="/programming/registering-phreplace-dll-in-windows-vista/">Registering phreplace DLL in Windows Vista</a>.</li>
  <li>Create a separate utility similar to regsvr32 and include this with phreplace. I think this is messy. Again see <a href="/programming/registering-phreplace-dll-in-windows-vista/">Registering phreplace DLL in Windows Vista</a>.</li>
  <li>Use the <a href="http://msdn.microsoft.com/en-us/library/ms973913.aspx" title="Registration-Free COM">Registration-Free COM</a> solution of adding a manifest file for PSPad which references the phreplace.dll library so that we don’t have to register it in the registry at all. This solution works for XP, see the <a href="https://www.assembla.com/code/phreplace/subversion/nodes/branches/reg-free-com?rev=5" title="reg-free-com branch of phreplace source code.">reg-free-com branch of the source code</a>, but doesn’t seem to work for Vista. My theory is that perhaps Vista handles vbscript differently, so it doesn’t inherit the PSPad manifest. If someone could get this working I think this is the most elegant solution.</li>
</ul>

<p>I look forward to seeing user contributions to this project.</p>



    <ul class="post-tags">
      
        <li><a href="/tag/news" title="View posts tagged with news">#news</a></li>
      
        <li><a href="/tag/phreplace" title="View posts tagged with phreplace">#phreplace</a></li>
      
    </ul>

  </div><!-- end .container -->
</article>

<div class="stripe">
  <div class="container">

    <nav class="row pager">
      <div class="previous col-xs-6 col-sm-4">
        
          <div class="meta-label"><a href="/programming/ie-autocomplete-doesnt-fire-onchange-event-handler/"><span aria-hidden="true">&laquo;</span> Previous post</a></div>
          <div class="meta-value"><a href="/programming/ie-autocomplete-doesnt-fire-onchange-event-handler/">IE Autocomplete Doesn't Fire onchange Event Handler</a></div>
        
      </div>
      <div class="next col-xs-6 col-sm-4 col-sm-offset-4">
        
          <div class="meta-label"><a href="/programming/logging-messages-in-dot-net/">Next post <span aria-hidden="true">&raquo;</span></a></div>
          <div class="meta-value"><a href="/programming/logging-messages-in-dot-net/">Logging Messages in Dot Net</a></div>
        
      </div>
    </nav><!-- end .post_nav -->

  </div><!-- end .container -->
</div><!-- end .stripe -->

    </main><!-- end .content -->

    
<footer role="contentinfo">
  <div class="container">

    <ul class="social-icons">
      <li><a href="https://twitter.com/pheasley" title="Follow me on Twitter"><i class="fa fa-twitter"></i></a></li>
      <li><a href="https://github.com/phdesign" title="See my code on GitHub"><i class="fa fa-github"></i></a></li>
      <li><a href="https://au.linkedin.com/in/pheasley" title="Connect with me on LinkedIn"><i class="fa fa-linkedin"></i></a></li>
      <li><a href="https://www.pinterest.com/paulheasley/" title="Follow me on Pinterest"><i class="fa fa-pinterest"></i></a></li>
      <li><a href="https://instagram.com/phdesign/" title="Me on Instagram"><i class="fa fa-instagram"></i></a></li>
    </ul>

    <p class="footer-copyright">
      &copy; 2015 Paul Heasley. All rights reserved. <br>
      Based on a <a href="http://guuthemes.com/" title="Much of the design of this site was based on a GuuThemes theme, big credit to their team for their beautiful art and clean code">GuuTheme</a>.
    </p>

  </div><!-- end .container -->
</footer>

    
<!-- JS (Javascript Files)
================================================== -->

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="/assets/js/main.js"></script>

  </body>

</html>
